{"ast":null,"code":"'use client';\n\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport { formatMuiErrorMessage as _formatMuiErrorMessage } from \"@mui/utils\";\nimport * as React from 'react';\nimport { unstable_useForkRef as useForkRef, unstable_useId as useId, unstable_useControlled as useControlled } from '@mui/utils';\nimport { extractEventHandlers } from '../utils/extractEventHandlers';\nimport { useFormControlContext } from '../FormControl';\nimport { clamp, isNumber } from './utils';\nconst STEP_KEYS = ['ArrowUp', 'ArrowDown', 'PageUp', 'PageDown'];\nconst SUPPORTED_KEYS = [...STEP_KEYS, 'Home', 'End'];\nexport function getInputValueAsString(v) {\n  return v ? String(v.trim()) : String(v);\n}\n/**\n *\n * Demos:\n *\n * - [Number Input](https://mui.com/base-ui/react-number-input/#hook)\n *\n * API:\n *\n * - [useNumberInput API](https://mui.com/base-ui/react-number-input/hooks-api/#use-number-input)\n */\n\nexport function useNumberInput(parameters) {\n  const {\n    min,\n    max,\n    step,\n    shiftMultiplier = 10,\n    defaultValue: defaultValueProp,\n    disabled: disabledProp = false,\n    error: errorProp = false,\n    onBlur,\n    onInputChange,\n    onFocus,\n    onChange,\n    required: requiredProp = false,\n    readOnly: readOnlyProp = false,\n    value: valueProp,\n    inputRef: inputRefProp,\n    inputId: inputIdProp\n  } = parameters; // TODO: make it work with FormControl\n\n  const formControlContext = useFormControlContext();\n  const {\n    current: isControlled\n  } = React.useRef(valueProp != null);\n  const handleInputRefWarning = React.useCallback(instance => {\n    if (process.env.NODE_ENV !== 'production') {\n      if (instance && instance.nodeName !== 'INPUT' && !instance.focus) {\n        console.error(['MUI: You have provided a `slots.input` to the input component', 'that does not correctly handle the `ref` prop.', 'Make sure the `ref` prop is called with a HTMLInputElement.'].join('\\n'));\n      }\n    }\n  }, []);\n  const inputRef = React.useRef(null);\n  const handleInputRef = useForkRef(inputRef, inputRefProp, handleInputRefWarning);\n  const inputId = useId(inputIdProp);\n  const [focused, setFocused] = React.useState(false); // the \"final\" value\n\n  const [value, setValue] = useControlled({\n    controlled: valueProp,\n    default: defaultValueProp,\n    name: 'NumberInput'\n  }); // the (potentially) dirty or invalid input value\n\n  const [dirtyValue, setDirtyValue] = React.useState(value ? String(value) : undefined);\n  React.useEffect(() => {\n    if (!formControlContext && disabledProp && focused) {\n      setFocused(false);\n      onBlur == null || onBlur();\n    }\n  }, [formControlContext, disabledProp, focused, onBlur]);\n\n  const createHandleFocus = otherHandlers => event => {\n    var _otherHandlers$onFocu;\n\n    (_otherHandlers$onFocu = otherHandlers.onFocus) == null || _otherHandlers$onFocu.call(otherHandlers, event);\n\n    if (event.defaultMuiPrevented || event.defaultPrevented) {\n      return;\n    }\n\n    if (formControlContext && formControlContext.onFocus) {\n      var _formControlContext$o;\n\n      formControlContext == null || (_formControlContext$o = formControlContext.onFocus) == null || _formControlContext$o.call(formControlContext);\n    }\n\n    setFocused(true);\n  };\n\n  const handleValueChange = () => (event, val) => {\n    let newValue;\n\n    if (val === undefined) {\n      newValue = val;\n      setDirtyValue('');\n    } else {\n      newValue = clamp(val, min, max, step);\n      setDirtyValue(String(newValue));\n    }\n\n    setValue(newValue);\n\n    if (isNumber(newValue)) {\n      onChange == null || onChange(event, newValue);\n    } else {\n      onChange == null || onChange(event, undefined);\n    }\n  };\n\n  const createHandleInputChange = otherHandlers => event => {\n    var _formControlContext$o2, _otherHandlers$onInpu;\n\n    if (!isControlled && event.target === null) {\n      throw new Error(process.env.NODE_ENV !== \"production\" ? `MUI: Expected valid input target. Did you use a custom \\`slots.input\\` and forget to forward refs? See https://mui.com/r/input-component-ref-interface for more info.` : _formatMuiErrorMessage(17));\n    }\n\n    formControlContext == null || (_formControlContext$o2 = formControlContext.onChange) == null || _formControlContext$o2.call(formControlContext, event);\n    (_otherHandlers$onInpu = otherHandlers.onInputChange) == null || _otherHandlers$onInpu.call(otherHandlers, event);\n\n    if (event.defaultMuiPrevented || event.defaultPrevented) {\n      return;\n    } // TODO: event.currentTarget.value will be passed straight into the InputChange action\n\n\n    const val = getInputValueAsString(event.currentTarget.value);\n\n    if (val === '' || val === '-') {\n      setDirtyValue(val);\n      setValue(undefined);\n    }\n\n    if (val.match(/^-?\\d+?$/)) {\n      setDirtyValue(val);\n      setValue(parseInt(val, 10));\n    }\n  };\n\n  const createHandleBlur = otherHandlers => event => {\n    var _otherHandlers$onBlur;\n\n    (_otherHandlers$onBlur = otherHandlers.onBlur) == null || _otherHandlers$onBlur.call(otherHandlers, event);\n\n    if (event.defaultMuiPrevented || event.defaultPrevented) {\n      return;\n    } // TODO: event.currentTarget.value will be passed straight into the Blur action, or just pass inputValue from state\n\n\n    const val = getInputValueAsString(event.currentTarget.value);\n\n    if (val === '' || val === '-') {\n      handleValueChange()(event, undefined);\n    } else {\n      handleValueChange()(event, parseInt(val, 10));\n    }\n\n    if (formControlContext && formControlContext.onBlur) {\n      formControlContext.onBlur();\n    }\n\n    setFocused(false);\n  };\n\n  const createHandleClick = otherHandlers => event => {\n    var _otherHandlers$onClic;\n\n    (_otherHandlers$onClic = otherHandlers.onClick) == null || _otherHandlers$onClic.call(otherHandlers, event);\n\n    if (event.defaultMuiPrevented || event.defaultPrevented) {\n      return;\n    }\n\n    if (inputRef.current && event.currentTarget === event.target) {\n      inputRef.current.focus();\n    }\n  };\n\n  const handleStep = direction => event => {\n    let newValue;\n\n    if (isNumber(value)) {\n      const multiplier = event.shiftKey || event.key === 'PageUp' || event.key === 'PageDown' ? shiftMultiplier : 1;\n      newValue = {\n        up: value + (step != null ? step : 1) * multiplier,\n        down: value - (step != null ? step : 1) * multiplier\n      }[direction];\n    } else {\n      // no value\n      newValue = {\n        up: min != null ? min : 0,\n        down: max != null ? max : 0\n      }[direction];\n    }\n\n    handleValueChange()(event, newValue);\n  };\n\n  const createHandleKeyDown = otherHandlers => event => {\n    var _otherHandlers$onKeyD;\n\n    (_otherHandlers$onKeyD = otherHandlers.onKeyDown) == null || _otherHandlers$onKeyD.call(otherHandlers, event);\n\n    if (event.defaultMuiPrevented || event.defaultPrevented) {\n      return;\n    }\n\n    if (event.defaultPrevented) {\n      return;\n    }\n\n    if (SUPPORTED_KEYS.includes(event.key)) {\n      event.preventDefault();\n    }\n\n    if (STEP_KEYS.includes(event.key)) {\n      const direction = {\n        ArrowUp: 'up',\n        ArrowDown: 'down',\n        PageUp: 'up',\n        PageDown: 'down'\n      }[event.key];\n      handleStep(direction)(event);\n    }\n\n    if (event.key === 'Home' && isNumber(max)) {\n      handleValueChange()(event, max);\n    }\n\n    if (event.key === 'End' && isNumber(min)) {\n      handleValueChange()(event, min);\n    }\n  };\n\n  const getRootProps = (externalProps = {}) => {\n    const propsEventHandlers = extractEventHandlers(parameters, [// these are handled by the input slot\n    'onBlur', 'onInputChange', 'onFocus', 'onChange']);\n\n    const externalEventHandlers = _extends({}, propsEventHandlers, extractEventHandlers(externalProps));\n\n    return _extends({}, externalProps, externalEventHandlers, {\n      onClick: createHandleClick(externalEventHandlers)\n    });\n  };\n\n  const getInputProps = (externalProps = {}) => {\n    var _ref;\n\n    const propsEventHandlers = {\n      onBlur,\n      onFocus,\n      // onChange from normal props is the custom onChange so we ignore it here\n      onChange: onInputChange\n    };\n\n    const externalEventHandlers = _extends({}, propsEventHandlers, extractEventHandlers(externalProps, [// onClick is handled by the root slot\n    'onClick' // do not ignore 'onInputChange', we want slotProps.input.onInputChange to enter the DOM and throw\n    ]));\n\n    const mergedEventHandlers = _extends({}, externalEventHandlers, {\n      onFocus: createHandleFocus(externalEventHandlers),\n      // slotProps.onChange is renamed to onInputChange and passed to createHandleInputChange\n      onChange: createHandleInputChange(_extends({}, externalEventHandlers, {\n        onInputChange: externalEventHandlers.onChange\n      })),\n      onBlur: createHandleBlur(externalEventHandlers),\n      onKeyDown: createHandleKeyDown(externalEventHandlers)\n    });\n\n    const displayValue = (_ref = focused ? dirtyValue : value) != null ? _ref : ''; // get rid of slotProps.input.onInputChange before returning to prevent it from entering the DOM\n    // if it was passed, it will be in mergedEventHandlers and throw\n\n    delete externalProps.onInputChange;\n    return _extends({\n      type: 'text',\n      id: inputId,\n      'aria-invalid': errorProp || undefined,\n      defaultValue: undefined,\n      value: displayValue,\n      'aria-valuenow': displayValue,\n      'aria-valuetext': String(displayValue),\n      'aria-valuemin': min,\n      'aria-valuemax': max,\n      autoComplete: 'off',\n      autoCorrect: 'off',\n      spellCheck: 'false',\n      required: requiredProp,\n      readOnly: readOnlyProp,\n      'aria-disabled': disabledProp,\n      disabled: disabledProp\n    }, externalProps, {\n      ref: handleInputRef\n    }, mergedEventHandlers);\n  };\n\n  const handleStepperButtonMouseDown = event => {\n    event.preventDefault();\n\n    if (inputRef.current) {\n      inputRef.current.focus();\n    }\n  };\n\n  const stepperButtonCommonProps = {\n    'aria-controls': inputId,\n    tabIndex: -1\n  };\n  const isIncrementDisabled = disabledProp || (isNumber(value) ? value >= (max != null ? max : Number.MAX_SAFE_INTEGER) : false);\n\n  const getIncrementButtonProps = (externalProps = {}) => {\n    return _extends({}, externalProps, stepperButtonCommonProps, {\n      disabled: isIncrementDisabled,\n      'aria-disabled': isIncrementDisabled,\n      onMouseDown: handleStepperButtonMouseDown,\n      onClick: handleStep('up')\n    });\n  };\n\n  const isDecrementDisabled = disabledProp || (isNumber(value) ? value <= (min != null ? min : Number.MIN_SAFE_INTEGER) : false);\n\n  const getDecrementButtonProps = (externalProps = {}) => {\n    return _extends({}, externalProps, stepperButtonCommonProps, {\n      disabled: isDecrementDisabled,\n      'aria-disabled': isDecrementDisabled,\n      onMouseDown: handleStepperButtonMouseDown,\n      onClick: handleStep('down')\n    });\n  };\n\n  return {\n    disabled: disabledProp,\n    error: errorProp,\n    focused,\n    formControlContext,\n    getInputProps,\n    getIncrementButtonProps,\n    getDecrementButtonProps,\n    getRootProps,\n    required: requiredProp,\n    value: focused ? dirtyValue : value,\n    isIncrementDisabled,\n    isDecrementDisabled,\n    inputValue: dirtyValue\n  };\n}","map":null,"metadata":{},"sourceType":"module"}